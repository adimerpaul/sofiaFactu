import{_ as Q,c as m,o as u,w as a,b as t,a as e,Q as _,e as g,d as p,a1 as d,t as r,aq as k,f as P,a5 as w,a6 as I,a7 as q,Z as v}from"./index-D7Xk6GjO.js";import{Q as f,a as i,b as h}from"./QMenu-CgzrJreP.js";import{Q as A,C as b}from"./ClosePopup-C30NQmyp.js";import{Q as $}from"./QChip-CTRdjuvH.js";import{Q as y}from"./QMarkupTable-C2kEUEae.js";import{Q as E}from"./QPage-BKNHMEr0.js";import{h as C}from"./moment-C5S46NFB.js";import{I as D}from"./Imprimir-CwwATIwK.js";import"./_commonjsHelpers-Bx2EM-6T.js";const F={data(){return{pedidos:[],fechaInicio:C().format("YYYY-MM-DD"),fechaFin:C().format("YYYY-MM-DD"),loading:!1,estados:[{label:"Pendiente",value:"Pendiente"},{label:"Aceptado",value:"Aceptado"},{label:"Anulado",value:"Anulado"}]}},computed:{totalPendientes(){return this.pedidos.filter(o=>o.estado==="Pendiente").length},totalEnviados(){return this.pedidos.filter(o=>o.estado==="Aceptado").length}},methods:{observaciones(o){this.$q.dialog({title:"Observaciones",message:"Ingrese las observaciones del pedido",prompt:{model:o.observaciones,type:"textarea",outlined:!0,label:"Observaciones"},cancel:!0,persistent:!0}).onOk(l=>{this.$axios.put(`/pedidos/${o.id}`,{observaciones:l}).then(()=>{this.cargarPedidos(),this.$alert.success("Observaciones guardadas")}).catch(()=>{this.$alert.error("Error al guardar las observaciones")})})},imprimir(o){D.reciboPedido(o)},aceptar(o){this.$q.dialog({title:"Aceptar Pedido",message:"¿Está seguro de aceptar este pedido?",cancel:!0,persistent:!0}).onOk(()=>{this.$axios.put(`/pedidos/${o}`,{estado:"Aceptado"}).then(()=>{this.cargarPedidos(),this.$alert.success("Pedido aceptado")}).catch(()=>{this.$alert.error("Error al aceptar el pedido")})})},anular(o){this.$q.dialog({title:"Anular Pedido",message:"¿Está seguro de anular este pedido?",cancel:!0,persistent:!0}).onOk(()=>{this.$axios.put(`/pedidos/${o}`,{estado:"Anulado"}).then(()=>{this.cargarPedidos(),this.$alert.success("Pedido anulado")}).catch(()=>{this.$alert.error("Error al anular el pedido")})})},cargarPedidos(){this.loading=!0,console.log(this.fechaInicio,this.fechaFin),this.$axios.get("/pedidos",{params:{fechaInicio:this.fechaInicio,fechaFin:this.fechaFin}}).then(o=>{this.pedidos=o.data.data||o.data}).catch(()=>{this.$alert.error("Error al obtener pedidos")}).finally(()=>{this.loading=!1})}},mounted(){this.cargarPedidos()}},O={class:"row"},V={class:"col-12 col-md-4 q-pa-xs"},Y={class:"col-12 col-md-4 q-pa-xs"},B={class:"col-12 col-md-4 q-pa-xs"},M={class:"row q-col-gutter-sm q-pa-sm"},z={class:"col-12 col-md-3"},N={class:"col-12 col-md-3"},S={class:"col-12 col-md-3"},U={class:"col-12 col-md-3"},L={style:{"max-width":"120px","wrap-option":"wrap","line-height":"0.9"}};function T(o,l,Z,j,n,c){return u(),m(E,{class:"q-pa-xs"},{default:a(()=>[t("div",O,[t("div",V,[e(_,{flat:"",bordered:""},{default:a(()=>[e(g,{class:"q-pa-none"},{default:a(()=>[e(f,{class:"bg-info"},{default:a(()=>[e(i,{avatar:""},{default:a(()=>[e(p,{name:"shopping_cart",size:"50px",color:"white"})]),_:1}),e(i,null,{default:a(()=>[e(h,{caption:"",class:"text-white"},{default:a(()=>l[3]||(l[3]=[d("Pedidos Pendientes")])),_:1}),e(h,{class:"text-white text-h4"},{default:a(()=>[d(r(c.totalPendientes),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),t("div",Y,[e(_,{flat:"",bordered:""},{default:a(()=>[e(g,{class:"q-pa-none"},{default:a(()=>[e(f,{class:"bg-green"},{default:a(()=>[e(i,{avatar:""},{default:a(()=>[e(p,{name:"local_shipping",size:"50px",color:"white"})]),_:1}),e(i,null,{default:a(()=>[e(h,{caption:"",class:"text-white"},{default:a(()=>l[4]||(l[4]=[d("Pedidos Aceptados")])),_:1}),e(h,{class:"text-white text-h4"},{default:a(()=>[d(r(c.totalEnviados),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),t("div",B,[e(_,{flat:"",bordered:""},{default:a(()=>[e(g,{class:"q-pa-none"},{default:a(()=>[e(f,{class:"bg-red"},{default:a(()=>[e(i,{avatar:""},{default:a(()=>[e(p,{name:"cancel",size:"50px",color:"white"})]),_:1}),e(i,null,{default:a(()=>[e(h,{caption:"",class:"text-white"},{default:a(()=>l[5]||(l[5]=[d("Pedidos Anulados")])),_:1}),e(h,{class:"text-white text-h4"},{default:a(()=>[d(r(n.pedidos.filter(s=>s.estado==="Anulado").length),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])]),e(_,{flat:"",bordered:"",class:"q-mt-sm"},{default:a(()=>[e(g,{class:"q-pa-none"},{default:a(()=>[t("div",M,[t("div",z,[e(k,{modelValue:n.fechaInicio,"onUpdate:modelValue":l[0]||(l[0]=s=>n.fechaInicio=s),label:"Fecha inicio",dense:"",outlined:"",type:"date"},null,8,["modelValue"])]),t("div",N,[e(k,{modelValue:n.fechaFin,"onUpdate:modelValue":l[1]||(l[1]=s=>n.fechaFin=s),label:"Fecha fin",dense:"",outlined:"",type:"date"},null,8,["modelValue"])]),t("div",S,[e(P,{color:"primary",label:"Buscar",icon:"search",onClick:c.cargarPedidos,loading:n.loading,"no-caps":""},null,8,["onClick","loading"])]),t("div",U,[e(P,{color:"positive",label:"Nuevo Pedido",icon:"add_circle_outline",onClick:l[2]||(l[2]=s=>o.$router.push("pedidosCompra")),"no-caps":""})])])]),_:1})]),_:1}),e(y,{dense:"","wrap-cells":""},{default:a(()=>[l[10]||(l[10]=t("thead",null,[t("tr",{class:"bg-primary text-white"},[t("th",null,"Opciones"),t("th",null,"ID"),t("th",null,"Fecha"),t("th",null,"Detalle"),t("th",null,"Usuario"),t("th",null,"Estado"),t("th",null,"Observaciones")])],-1)),t("tbody",null,[(u(!0),w(I,null,q(n.pedidos,s=>(u(),w("tr",{key:s.id},[t("td",null,[e(A,{color:"primary",label:"Opciones","no-caps":"",dense:"",size:"10px"},{default:a(()=>[v((u(),m(f,{clickable:"",onClick:x=>c.aceptar(s.id)},{default:a(()=>[e(i,{avatar:""},{default:a(()=>[e(p,{name:"check"})]),_:1}),e(i,null,{default:a(()=>l[6]||(l[6]=[d("Aceptar")])),_:1})]),_:2},1032,["onClick"])),[[b]]),v((u(),m(f,{clickable:"",onClick:x=>c.anular(s.id)},{default:a(()=>[e(i,{avatar:""},{default:a(()=>[e(p,{name:"delete"})]),_:1}),e(i,null,{default:a(()=>l[7]||(l[7]=[d("Anular")])),_:1})]),_:2},1032,["onClick"])),[[b]]),v((u(),m(f,{clickable:"",onClick:x=>c.imprimir(s)},{default:a(()=>[e(i,{avatar:""},{default:a(()=>[e(p,{name:"print"})]),_:1}),e(i,null,{default:a(()=>l[8]||(l[8]=[d("Imprimir")])),_:1})]),_:2},1032,["onClick"])),[[b]]),v((u(),m(f,{clickable:"",onClick:x=>c.observaciones(s)},{default:a(()=>[e(i,{avatar:""},{default:a(()=>[e(p,{name:"edit"})]),_:1}),e(i,null,{default:a(()=>l[9]||(l[9]=[d("Observaciones")])),_:1})]),_:2},1032,["onClick"])),[[b]])]),_:2},1024)]),t("td",null,r(s.id),1),t("td",null,r(s.fecha)+" "+r(s.hora),1),t("td",L,r(s.textDetalle),1),t("td",null,r(s.user?.name),1),t("td",null,[e($,{color:s.estado==="Pendiente"?"orange":s.estado==="Aceptado"?"green":"red",class:"text-white",dense:""},{default:a(()=>[d(r(s.estado),1)]),_:2},1032,["color"])]),t("td",null,r(s.observaciones),1)]))),128))])]),_:1}),l[11]||(l[11]=t("div",{id:"myElement",class:"hidden"},null,-1))]),_:1})}const te=Q(F,[["render",T]]);export{te as default};
